<!-- templates/delete_account.html -->
{% extends "base.html" %}

{% block content %}
<h2 class="text-center text-danger">⚠️ حذف حساب کاربری</h2>
<p class="text-center text-muted">برای حذف اکانت خود، روی دکمه زیر کلیک کنید. پنجره تأیید نمایش داده خواهد شد.</p>

<div class="text-center mt-4">
    <button id="deleteBtn" class="btn btn-danger">حذف حساب کاربری</button>
</div>

<div id="deleteModal" class="modal-overlay">
    <div class="modal-box">
        <p>آیا مطمئن هستید که می‌خواهید حساب خود را حذف کنید؟</p>
        <div class="modal-actions">
            <button class="btn btn-secondary" onclick="closeModal()">لغو</button>
            <button class="btn btn-danger" onclick="confirmDelete()">بله، حذف کن</button>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function () {
    const deleteBtn = document.getElementById('deleteBtn');
    const deleteModal = document.getElementById('deleteModal');

    if (deleteBtn && deleteModal) {
        deleteBtn.addEventListener('click', () => {
            deleteModal.classList.add('active');
        });
    }

    window.closeModal = function () {
        deleteModal.classList.remove('active');
    };

    window.confirmDelete = function () {
        fetch('/confirm_delete', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            }
        }).then(res => {
            if (res.ok) {
                window.location.href = '/login';
            } else {
                alert('مشکلی در حذف حساب پیش آمد.');
            }
        });
    };
});
</script>
{% endblock %}
